<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>Jasmine Spec Runner</title>

  <link rel="stylesheet" type="text/css" href="vendor/jasmine.css">

  <script type="text/javascript" src="vendor/jasmine.js"></script>
  <script type="text/javascript" src="vendor/jasmine-html.js"></script>
  <script type="text/javascript" src="vendor/jasmine-jquery.js"></script>
  <script type="text/javascript" src="vendor/jquery.js"></script>
  <script type="text/javascript" src="vendor/coffee-script.js"></script>

  <script type="text/javascript" src="build/textext.jquery.js"></script>
  <script type="text/javascript" src="build/vendor/eventemitter2.js"></script>
  <script type="text/javascript" src="build/vendor/watch.js"></script>
  <script type="text/javascript" src="build/vendor/resistance.js"></script>
  <script type="text/javascript" src="build/utils.js"></script>
  <script type="text/javascript" src="build/plugin.js"></script>
  <script type="text/javascript" src="build/items_manager.js"></script>
  <script type="text/javascript" src="build/ui_plugin.js"></script>
  <script type="text/javascript" src="build/textext.js"></script>
  <script type="text/javascript" src="build/keys_plugin.js"></script>
  <script type="text/javascript" src="build/tags_plugin.js"></script>
  <script type="text/javascript" src="build/input_plugin.js"></script>

  <script type="text/coffeescript" src="textext.spec.coffee"></script>
  <script type="text/coffeescript" src="utils.spec.coffee"></script>
  <script type="text/coffeescript" src="plugin.spec.coffee"></script>
  <script type="text/coffeescript" src="ui_plugin.spec.coffee"></script>
  <script type="text/coffeescript" src="keys_plugin.spec.coffee"></script>
  <script type="text/coffeescript" src="tags_plugin.spec.coffee"></script>
  <script type="text/coffeescript" src="input_plugin.spec.coffee"></script>
  <script type="text/coffeescript" src="items_manager.spec.coffee"></script>

  <script type="text/coffeescript">
    do ->
      env = jasmine.getEnv()
      env.updateInterval = 1000

      reporter = new jasmine.HtmlReporter()

      env.addReporter(reporter)
      env.specFilter = (spec) -> reporter.specFilter(spec)

      window.waitForEvent = window.expectEvent = (target, event, trigger, timeout = 250) ->
        fired = false
        handler = ->  fired = true
        target.on event, handler

        runs -> trigger()
        waitsFor (-> fired), "`#{event}` event to be emitted", timeout
        runs -> target.off event, handler

      _waitsFor = window.waitsFor

      window.waitsFor = (args...) ->
        args.push 250
        _waitsFor.apply window, args

      window.wait = (fn) ->
        done = false
        runs -> fn -> done = true
        waitsFor -> done

      # beforeEach ->
      #   @addMatchers

      $ ->
        # $('body').append '<input id="example">'
        # $('#example').textext plugins : 'tags'

        setTimeout ->
          $('body > *:first').before '<input id="example">'

          try
            $('#example').textext plugins : 'tags'
          catch e
            console.error e.stack
        , 1000

        env.execute()
  </script>

</head>

<body>
</body>
</html>

